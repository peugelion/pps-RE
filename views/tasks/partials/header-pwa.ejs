<script>
  /* PWA prompt 2018.10.23 */
  
  var btnAdd = document.getElementById('idInstallPwaBtn'); // PWA install btn
  var deferredPrompt;           // PWA prompt
  
  //function ionViewWillEnter(){
    window.addEventListener('beforeinstallprompt', (e) => {
        console.log('beforeinstallprompt USAOOO');
        // Prevent Chrome 67 and earlier from automatically showing the prompt
        e.preventDefault();
        // Stash the event so it can be triggered later on the button event.
        deferredPrompt = e;
       
        // Update UI by showing a button to notify the user they can add to home screen
        //$('idInstallPwaBtn').toggleClass('hidden');
        btnAdd.style.display = 'block';
    });

    //button click event to show the promt
    window.addEventListener('appinstalled', (event) => {
      console.log('pwa app already installed');
    });
    if (window.matchMedia('(display-mode: standalone)').matches) {
      console.log('display-mode is standalone - pwa app launched from the home screen ANDROID');
    }
    // if (window.navigator.standalone === true) {
    //   console.log('display-mode is standalone - pwa app launched from the home screen SAFARI');
    // }
  //}
 
  function add_to_home(e){
    debugger
    // hide our user interface that shows our button
    // Show the prompt
    deferredPrompt.prompt();
    // Wait for the user to respond to the prompt
    deferredPrompt.userChoice
      .then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the prompt');
            // hide our user interface that shows our A2HS button
            btnAdd.style.display = 'none';
        } else {
          console.log('User dismissed the prompt');
        }
        deferredPrompt = null;
      });
  }
  </script>